/* online.js  @author M.Taniguchi https://masatotaniguchi.jp/ */
function Boot(e){game=e,ap.InitAudio(),window.addEventListener("pageshow",function(){ap.Mute(!1)},!1),window.addEventListener("pagehide",function(){ap.Mute(!0)},!1);var n,a;"undefined"!=typeof document.hidden?(n="hidden",a="visibilitychange"):"undefined"!=typeof document.mozHidden?(n="mozHidden",a="mozvisibilitychange"):"undefined"!=typeof document.msHidden?(n="msHidden",a="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(n="webkitHidden",a="webkitvisibilitychange"),document.addEventListener(a,function(){ap.Mute(document.hidden)},!1),"sp"==getDevice?Detector.webgl?($('a[rel="external"]').click(function(){return productWindow&&productWindow.close(),productWindow=window.open($(this).attr("href"),$(this).attr("target")),!1}),args=app.GetUrlVars(),setTimeout(function(){app.Initialize(args.mode,!0,args.reset,function(){game.Initialize(function(){app.Start(),$(".Title ul").addClass("Enable")})},WaitPortrait,Unsupported,void 0,!1)},25)):Unsupported():(EnableTouchScroll(!1),$("html,body").scrollTop(0),$("#Incompatible").css("display","block"))}function Unsupported(){EnableTouchScroll(!1),$("html,body").scrollTop(0),$("#Unsupported").css("display","block")}function Start(e){if(ap.PrePlay(),game.IsInitialized()){EnableTouchScroll(!1);var n=0;"hockey"==game.Name()&&(n=571*$(window).width()/375-$(window).height(),n=n>0?n/2:0),$("html,body").scrollTop(n),$(".Title").css("display","none"),game.Start(e)}return!1}function WaitPortrait(e){$("#WaitPortrait").css("display",e?"block":"none"),e?(EnableTouchScroll(!1),$("html,body").scrollTop(0)):EnableTouchScroll(!0)}function Title(e){return $(".Title").css("display",e?"block":"none"),$(".Transition").each(function(e,n){$(n).removeClass("Fadein")}),$(".Result h1 div").removeClass("Move"),"hockey"==game.Name()&&$(".Symbol").removeClass("Move"),e&&EnableTouchScroll(!0),!1}function Result(e,n,a){resultEle||(resultEle=$(".Result"));var t=e?"block":"none";return resultEle.css("display")!=t&&("drive"==game.Name()?$(".Result article > h1 > div").html(n?"<span></span><span>Y</span><span>O</span><span>U</span><span> </span><span>W</span><span>I</span><span>N</span><span></span>":"<span>G</span><span>A</span><span>M</span><span>E</span><span> </span><span>O</span><span>V</span><span>E</span><span>R</span>"):$(".Result article > h1 > div").html(n?"<span></span><span>Y</span><span>O</span><span>U</span><span> </span><span>W</span><span>I</span><span>N</span><span></span>":"<span>U</span><span>N</span><span>I</span><span> </span><span>W</span><span>I</span><span>N</span><span>S</span>"),resultEle.css("display",t),$(".Result .Scroll").scrollTop(0),e?($("html,body").animate({scrollTop:0},1e3),"hockey"==game.Name()&&(n?$(".Symbol#Rex").addClass("Move"):$(".Symbol#Uni").addClass("Move")),timer2=setTimeout(function(){timer2=null,$(".Result li").each(function(e,n){$(n).css("display",a[e]?"block":"none")}),timer=setTimeout(function(){timer=null;var e=0;$(".Transition").each(function(n,a){if("none"!=$(a).css("display")){var t=66*e+"ms";$(a).css("transition-delay",t).css("-webkit-transition-delay",t).css("-moz-transition-delay",t).css("-o-transition-delay",t),$(a).addClass("Fadein"),e++}})},1750),$(".Result h1 div").addClass("Move"),EnableTouchScroll(!0)},"hockey"==game.Name()?500:1)):(timer&&(clearTimeout(timer),timer=null),timer2&&(clearTimeout(timer2),timer2=null))),!1}function Replay(){return ga("send","event","drive"!=game.Name()?"RH":"ND","Game Over","PLAYAGAIN",!0),Result(!1),Title(!0),game.Reset(),!1}function HowTo(e){return $(".HowTo").css("display",e?"block":"none"),$(".HowTo .Scroll").scrollTop(0),!1}function Ticket(e){return e&&ga("send","event","drive"!=game.Name()?"RH":"ND","Game Over","DL",!0),$(".Ticket").css("display",e?"block":"none"),e?$(".Scroll").css("pointer-events","none").css("-webkit-overflow-scrolling","auto"):$(".Scroll").css("pointer-events","auto").css("-webkit-overflow-scrolling","touch"),!1}function Detail(e){return e&&ga("send","event","drive"!=game.Name()?"RH":"ND","Game Over","Detail",!0),$(".Description").css("display",e?"block":"none"),$(".Description .Scroll").scrollTop(0),!1}function Terms(e){return e&&ga("send","event","drive"!=game.Name()?"RH":"ND","Game Over","TC",!0),$(".Terms").css("display",e?"block":"none"),$(".Terms .Scroll").scrollTop(0),!1}function ShareFacebook(e){return ga("send","event","drive"!=game.Name()?"RH":"ND","Game Over","FB",!0),facebookWindow&&facebookWindow.close(),facebookWindow=window.open($(e).attr("href"),$(e).attr("target")),!1}function ShareTwitter(e){return ga("send","event","drive"!=game.Name()?"RH":"ND","Game Over","TW",!0),twitterWindow&&twitterWindow.close(),twitterWindow=window.open($(e).attr("href"),$(e).attr("target")),!1}function ShareLine(e){return ga("send","event","drive"!=game.Name()?"RH":"ND","Game Over","LINE",!0),lineWindow&&lineWindow.close(),lineWindow=window.open($(e).attr("href"),$(e).attr("target")),!1}function ToggleAudio(){return audioSwitch=0==audioSwitch,ap.Toggle(audioSwitch),!1}var game=null,args,productWindow=null,resultEle,timer=null,timer2=null,facebookWindow=null,twitterWindow=null,lineWindow=null,audioSwitch=!0;