/* app.js  @author M.Taniguchi https://masatotaniguchi.jp/ */
var app=app||{};app.version="1",app.PlaneShader={uniforms:{alpha:{value:1}},vertexShader:["varying vec2	vUv;","varying vec4	vPos;","void main() {","vUv = uv;","vPos = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","gl_Position = vPos;","}"].join("\n"),fragmentShader:["uniform sampler2D	texture;","uniform float	alpha;","varying vec2	vUv;","void main() {","vec4	col = texture2D(texture, vUv);","col.a *= alpha;","if (col.a <= 0.0) discard;","gl_FragColor = col;","}"].join("\n")},app.DotShader={uniforms:{tDiffuse:{value:null},scale:{value:1},round:{value:0},alpha:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","}"].join("\n"),fragmentShader:["uniform vec2 scale;","uniform float round;","uniform float alpha;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 color;","if (round >= 1.0) {","vec2	m = mod(vUv * scale, 1.0);","color = texture2D(tDiffuse, vUv - (m - 0.5) / scale);","m -= 0.5;","float	l = min(1.0, (m.x * m.x + m.y * m.y) * round);","l = 1.0 - l * l * l;","if (l < 0.015625) discard;","color.rgb *= l;","} else {","color = texture2D(tDiffuse, vUv);","}","color.rgb *= alpha;","gl_FragColor = color;","}"].join("\n")},app.BlurShader={uniforms:{},vertexShader:["uniform float	alpha;","uniform vec3	offset;","varying vec2	vUv;","varying float	fade;","void main() {","vec4	pos = vec4(position, 1);","pos.x += normal.x * offset.x;","pos.y += normal.x * offset.y;","pos.z += normal.x * offset.z;","fade = normal.y * alpha;","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * pos;","}"].join("\n"),fragmentShader:["uniform sampler2D texture;","varying vec2	vUv;","varying float	fade;","void main() {","if (fade <= 0.0) discard;","vec4 col = texture2D(texture, vUv);","col.r = (col.r + 0.3) * 1.1;","col.g = (col.g + 0.3) * 1.1;","col.b = (col.b + 0.3) * 1.1;","col.a *= fade;","if (col.a <= 0.0) discard;","gl_FragColor = col;","}"].join("\n")},app.NumberShader={uniforms:{},vertexShader:["uniform float	number;","uniform float	alpha;","varying vec2	vUv;","varying vec4	vPos;","varying float	alpha_;","void main() {","if (normal.x == 1.0 || number >= normal.x) {","float	v = floor(mod(number / normal.x, 10.0));","vUv = uv;","vUv.x += v * 0.09375 * normal.y;","alpha_ = alpha;","} else {","alpha_ = 0.0;","}","gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","}"].join("\n"),fragmentShader:["uniform sampler2D	texture;","varying vec2	vUv;","varying float	alpha_;","void main() {","vec4	col = texture2D(texture, vUv);","col.a *= alpha_;","if (col.a <= 0.0) discard;","gl_FragColor = col;","}"].join("\n")},app.NumberBlurShader={uniforms:{},vertexShader:["uniform float	number;","uniform vec3	offset;","uniform float	alpha;","varying vec2	vUv;","varying vec4	vPos;","varying float	fade;","void main() {","vec4	pos = vec4(position, 1);","pos.x += normal.x * offset.x;","pos.y += normal.x * offset.y;","pos.z += normal.x * offset.z;","fade = normal.y * alpha;","vUv = uv;","vUv.x += number * 0.09375;","gl_Position = projectionMatrix * modelViewMatrix * pos;","}"].join("\n"),fragmentShader:["uniform sampler2D	texture;","varying vec2	vUv;","varying float	fade;","void main() {","if (fade <= 0.0) discard;","vec4	col = texture2D(texture, vUv);","col.r = (col.r + 0.3) * 1.1;","col.g = (col.g + 0.3) * 1.1;","col.b = (col.b + 0.3) * 1.1;","col.a *= fade;","if (col.a <= 0.0) discard;","gl_FragColor = col;","}"].join("\n")},app.canvas,app.renderer,app.scene,app.camera,app.offline=!1,app.pause=0,app.initializedFunction,app.landscapeFunction,app.resizeFunction,app.gameUpdateFunction,app.gameInputFunction,app.disableGyro=!1,app.initialized=0,app.initCode=0,app.frontRenderTarget,app.backRenderTarget,app.offRenderTarget,app.frontScreen,app.backScreen,app.frontMat,app.backMat,app.frontScene,app.backScene,app.uiScene,app.uiBackScene,app.offBackScene,app.frontCamera,app.cameraZ,app.cameraParallax=[0,0,0,0],app.uiFix=!1,app.scanline=[0,0],app.realTime=0,app.time=0,app.realDeltaTime=0,app.deltaTime=0,app.updating=!1,app.drawing=!1,app.width=192,app.height=571*app.width/375,app.dispWidth=192,app.dispHeight=571*app.width/375,app.clientWidth=256,app.clientHeight=256,app.holoWidth=app.width,app.fov=60,app.textureLoader,app.texture,app.fontTexture,app.numberTexture,app.keyDown=null,app.keyTrigger=null,app.paddleSpeed=100,app.paddleX=0,app.mouseX,app.controleEle=null,app.touchX=0,app.touchY=0,app.holoPosX=0,app.holoPosY=0,app.holoScale=0,app.holoTexScale=0,app.holoFlip=0,app.visibleScanline=0,app.holographEle=null,app.deviceOrientation,app.gyroOrigin,app.gyroInverseOrigin,app.gyroDistance=0,app.gyroDistanceAvg=10,app.dotScale=1,app.tgtDotScale=1,app.fade=[1,1],app.fpsCount=0,app.fpsTime=0,app.fpsEle=null,app.debug=!0,app.debugShow=!1,app.debugEle=null,app.tempEle=null,app.stats,app.numberTable={0:[0,0,.09375,.75,.09375,.09375],1:[.09375,0,.09375,.75,.09375,.09375],2:[.1875,0,.09375,.75,.09375,.09375],3:[.28125,0,.09375,.75,.09375,.09375],4:[.375,0,.09375,.75,.09375,.09375],5:[.46875,0,.09375,.75,.09375,.09375],6:[.5625,0,.09375,.75,.09375,.09375],7:[.65625,0,.09375,.75,.09375,.09375],8:[.75,0,.09375,.75,.09375,.09375],9:[.84375,0,.09375,.75,.09375,.09375],",":[.9375,0,.0234375,.75,.0234375,.09375]},app.fontTable={0:[.28125,0,.09375,.09375,.09375,.09375],1:[.375,0,.09375,.09375,.09375,.09375],2:[.46875,0,.09375,.09375,.09375,.09375],3:[.5625,0,.09375,.09375,.09375,.09375],4:[.65625,0,.09375,.09375,.09375,.09375],5:[.75,0,.09375,.09375,.09375,.09375],6:[.84375,0,.09375,.09375,.09375,.09375],7:[0,.09375,.09375,.09375,.09375,.09375],8:[.09375,.09375,.09375,.09375,.09375,.09375],9:[.1875,.09375,.09375,.09375,.09375,.09375],A:[.28125,.09375,.09375,.09375,.09375,.09375],B:[.375,.09375,.09375,.09375,.09375,.09375],"<":[.46875,.09375,.09375,.09375,.09375,.09375],">":[.5625,.09375,.09375,.09375,.09375,.09375],C:[.65625,.09375,.09375,.09375,.09375,.09375],":":[.09375,.375,.078125,.09375,.078125,.09375],",":[.9375,.1875,.0234375,.09375,.0234375,.09375],D:[.75,.09375,.09375,.09375,.09375,.09375],E:[.84375,.09375,.09375,.09375,.09375,.09375],F:[0,.1875,.09375,.09375,.09375,.09375],G:[.09375,.1875,.09375,.09375,.09375,.09375],H:[.1875,.1875,.09375,.09375,.09375,.09375],I:[.9375,0,.046875,.09375,.046875,.09375],I2:[.28125,.1875,.09375,.09375,.09375,.09375],J:[.375,.1875,.09375,.09375,.09375,.09375],K:[.46875,.1875,.09375,.09375,.09375,.09375],L:[.5625,.1875,.09375,.09375,.09375,.09375],M:[0,0,.140625,.09375,.140625,.09375],M2:[.65625,.1875,.09375,.09375,.09375,.09375],N:[.75,.1875,.09375,.09375,.09375,.09375],O:[.84375,.1875,.09375,.09375,.09375,.09375],P:[0,.28125,.09375,.09375,.09375,.09375],Q:[.09375,.28125,.09375,.09375,.09375,.09375],R:[.1875,.28125,.09375,.09375,.09375,.09375],S:[.28125,.28125,.09375,.09375,.09375,.09375]," ":[.9375,.09375,.046875,.09375,.046875,.09375],T:[.375,.28125,.09375,.09375,.09375,.09375],U:[.46875,.28125,.09375,.09375,.09375,.09375],V:[.5625,.28125,.09375,.09375,.09375,.09375],W:[.140625,0,.140625,.09375,.140625,.09375],W2:[.65625,.28125,.09375,.09375,.09375,.09375],X:[.75,.28125,.09375,.09375,.09375,.09375],Y:[.84375,.28125,.09375,.09375,.09375,.09375],Z:[0,.375,.09375,.09375,.09375,.09375]},app.symbolTable={DriveSymbolRex:[0,0,.5,.5,.5,.5],HockeySymbolRex:[.5,0,.5,.5,.5,.5],HockeySymbolUni:[0,.5,.5,.5,.5,.5]},app.table={"Black-cars00001":[.2265625,.4375,.09375,.125,.09375,.0625],"Black-cars00002":[.109375,.453125,.09375,.125,.09375,.0625],"Black-cars00003":[.3203125,.453125,.09375,.125,.09375,.0625],"Black-cars00004":[.4140625,.453125,.09375,.125,.09375,.0625],"Black-cars00005":[.890625,.453125,.09375,.125,.09375,.0625],Black:[.859375,.203125,.0078125,.015625,.0078125,.0078125],"Buildings-left00001":[.71875,.53125,.0703125,.140625,.0703125,.0703125],"Buildings-left00002":[.5078125,.453125,.046875,.234375,.046875,.1171875],"Buildings-left00003":[.8671875,0,.0625,.34375,.0625,.171875],"Buildings-left00004":[.203125,.5625,.046875,.203125,.046875,.1015625],"Buildings-left00005":[.8515625,.34375,.0390625,.34375,.0390625,.171875],"Buildings-left00006":[.6640625,0,.0859375,.34375,.0859375,.171875],"Buildings-left00007":[.8515625,.6875,.0390625,.125,.0390625,.0625],"Buildings-left00008":[0,.21875,.125,.171875,.125,.0859375],"Buildings-left00009":[.140625,.578125,.046875,.1875,.046875,.09375],"Buildings-left00010":[.890625,.578125,.0390625,.1875,.0390625,.09375],"Buildings-left00011":[.5546875,.609375,.046875,.15625,.046875,.078125],"Buildings-left00012":[0,.515625,.046875,.234375,.046875,.1171875],"Buildings-left00013":[.296875,.703125,.0390625,.125,.0390625,.0625],"Buildings-left00014":[.625,.34375,.078125,.1875,.078125,.09375],"Buildings-left00015":[.3359375,.703125,.0390625,.125,.0390625,.0625],"Buildings-right00001":[.671875,.53125,.046875,.21875,.046875,.109375],"Buildings-right00002":[.9296875,0,.0390625,.453125,.0390625,.2265625],"Buildings-right00003":[.375,.703125,.0390625,.125,.0390625,.0625],"Buildings-right00004":[.046875,.515625,.046875,.234375,.046875,.1171875],"Buildings-right00005":[.9296875,.578125,.0390625,.1875,.0390625,.09375],"Buildings-right00006":[.578125,.25,.046875,.359375,.046875,.1796875],"Buildings-right00007":[.4140625,.703125,.0390625,.125,.0390625,.0625],"Buildings-right00008":[.890625,.34375,.0234375,.109375,.0234375,.0546875],"Buildings-right00009":[.71875,.671875,.046875,.15625,.046875,.078125],"Buildings-right00010":[.96875,0,.03125,.421875,.03125,.2109375],"Buildings-right00011":[.8125,.40625,.0390625,.296875,.0390625,.1484375],"Buildings-right00012":[.25,.5625,.046875,.203125,.046875,.1015625],"Buildings-right00013":[.625,.53125,.046875,.234375,.046875,.1171875],"Buildings-right00014":[.09375,.578125,.046875,.203125,.046875,.1015625],"Buildings-right00015":[.484375,.6875,.0625,.109375,.0625,.0546875],"Buildings-right00016":[.765625,.671875,.046875,.140625,.046875,.0703125],Car:[.75,0,.1171875,.203125,.1171875,.1015625],Check:[.125,.21875,.0078125,.015625,.0078125,.0078125],Circle:[.296875,.578125,.0625,.125,.0625,.0625],CircleBlur:[.359375,.578125,.0625,.125,.0625,.0625],Crash:[.1640625,0,.125,.25,.125,.125],DriveBG:[.625,.25,.03125,.0625,.03125,.03125],DriveRex:[.671875,.75,.046875,.078125,.046875,.0390625],GiftBox1:[.3203125,.25,.0859375,.203125,.0859375,.1015625],GiftBox2:[.40625,.25,.0859375,.203125,.0859375,.1015625],GiftBox3:[.4921875,.25,.0859375,.203125,.0859375,.1015625],HockeyBar:[.8515625,.203125,.0078125,.03125,.0078125,.015625],HockeyBg1:[.2890625,0,.125,.25,.125,.125],HockeyBg1b:[.4140625,0,.125,.25,.125,.125],HockeyBg2:[.140625,.765625,.125,.03125,.125,.015625],HockeyBg3:[.5390625,0,.125,.25,.125,.125],HockeyRex:[.75,.203125,.1015625,.203125,.1015625,.1015625],HockeyUni:[.125,.25,.1015625,.203125,.1015625,.1015625],HockeyWall:[.984375,.421875,.015625,.265625,.015625,.1328125],Mask:[.2265625,.25,.09375,.1875,.09375,.09375],Mountain:[0,0,.1640625,.21875,.1640625,.109375],Pack:[0,.75,.046875,.09375,.046875,.046875],PackShadow:[.046875,.75,.046875,.09375,.046875,.046875],Paddle1:[0,.390625,.109375,.125,.109375,.0625],Paddle2:[.703125,.40625,.109375,.125,.109375,.0625],Road:[.546875,.765625,.09375,.015625,.09375,.0078125],SunHalo:[.421875,.578125,.0625,.125,.0625,.0625],VolumeOff:[.703125,.34375,.03125,.0625,.03125,.03125],VolumeOn:[.96875,.6875,.03125,.0625,.03125,.03125],White:[.1328125,.21875,.0078125,.015625,.0078125,.0078125]},app.SetRenderSize=function(a){if(app.renderer)if(app.offline){var p=app.canvas.clientWidth,e=Math.round(app.canvas.clientWidth*app.dispHeight/(2*app.dispWidth)),t=app.renderer.getSize();(a||p!=t.width||e!=t.height)&&app.renderer.setSize(p,e)}else(app.canvas.clientWidth<app.canvas.clientHeight||a)&&(app.renderer.setSize(2*app.width,2*app.height),0!=app.pause&&(app.pause=app.realTime))},app.OnWindowResizeThree=function(){app.renderer&&(app.SetRenderSize(),app.InitCamera()),app.resizeFunction&&app.resizeFunction(.01*(100+app.holoScale),app.holoPosX/app.width,app.holoPosY/app.height,app.holoFlip)},app.InitThree=function(){app.canvas=document.getElementById("WebGLContainer"),app.renderer=new THREE.WebGLRenderer({alpha:!1,antialias:!1}),app.renderer.setPixelRatio(app.offline?1:.5),app.renderer.setClearColor(0,0),app.renderer.autoClear=!1,app.SetRenderSize(!0),app.canvas.appendChild(app.renderer.domElement),app.scene=new THREE.Scene},app.InitCamera=function(){if(app.camera=new THREE.OrthographicCamera(app.width*-.5,.5*app.width,.5*app.height,app.height*-.5,1,10),app.camera.position.set(0,0,5),app.camera.up.set(0,1,0),app.offline?app.cameraDepth=210.4441731196186:app.cameraDepth=238.81747474867365,app.frontCamera)var a=app.frontCamera.rotation;app.frontCamera=new THREE.PerspectiveCamera(app.fov,app.width/app.height,1,app.cameraDepth+1001),app.frontCamera.position.set(0,0,app.cameraDepth),app.frontCamera.up.set(0,1,0),a&&app.frontCamera.rotation.set(a.x,a.y,a.z)},app.InitOffscreen=function(){app.frontRenderTarget=new THREE.WebGLRenderTarget(app.width,app.height,{magFilter:THREE.NearestFilter,minFilter:THREE.NearestFilter,wrapS:THREE.ClampToEdgeWrapping,wrapT:THREE.ClampToEdgeWrapping}),app.backRenderTarget=new THREE.WebGLRenderTarget(app.holoWidth,app.height,{magFilter:THREE.NearestFilter,minFilter:THREE.NearestFilter,wrapS:THREE.ClampToEdgeWrapping,wrapT:THREE.ClampToEdgeWrapping}),app.frontScene=new THREE.Scene,app.backScene=new THREE.Scene,app.uiScene=new THREE.Scene,app.uiBackScene=app.offline?new THREE.Scene:app.uiScene,app.offline&&(app.offRenderTarget=new THREE.WebGLRenderTarget(app.width,app.height,{magFilter:THREE.NearestFilter,minFilter:THREE.NearestFilter,wrapS:THREE.ClampToEdgeWrapping,wrapT:THREE.ClampToEdgeWrapping}),app.offScene=new THREE.Scene)},app.CreateMesh=function(a,p,e,t,i){var r=new THREE.BufferGeometry;a*=.5,p*=.5,e*=.5;var n=new Float32Array([-a,-p,e,a,-p,e,a,p,-e,-a,p,-e]);r.addAttribute("position",new THREE.BufferAttribute(n,3));var o;o=void 0==i?new Float32Array([0,0,1,0,1,1,0,1]):new Float32Array([i[0],i[1],i[0]+i[2],i[1],i[0]+i[2],i[1]+i[3],i[0],i[1]+i[3]]),r.addAttribute("uv",new THREE.BufferAttribute(o,2));var l=new Uint16Array([0,1,2,0,2,3]);return r.setIndex(new THREE.BufferAttribute(l,1)),r.addGroup({start:0,count:6}),new THREE.Mesh(r,t)},app.CreateBlurMesh=function(a,p,e,t,i,r){r||(r=1);var n=new THREE.BufferGeometry;a*=.5,p*=.5,e*=.5;for(var o,l=new Float32Array(12*r),d=0;r>d;d++)o=4*d*3,l[o]=-a,l[o+1]=-p,l[o+2]=-e,l[o+3]=a,l[o+4]=-p,l[o+5]=e,l[o+6]=a,l[o+7]=p,l[o+8]=-e,l[o+9]=-a,l[o+10]=p,l[o+11]=-e;n.addAttribute("position",new THREE.BufferAttribute(l,3));var u;u=new Float32Array(8*r);for(var o,d=0;r>d;d++)o=4*d*2,u[o]=i[0],u[o+1]=i[1],u[o+2]=i[0]+i[2],u[o+3]=i[1],u[o+4]=i[0]+i[2],u[o+5]=i[1]+i[3],u[o+6]=i[0],u[o+7]=i[1]+i[3];n.addAttribute("uv",new THREE.BufferAttribute(u,2));var c;c=new Float32Array(12*r);for(var o,s,d=0;r>d;d++){o=4*d*3,s=1-(1-d/r),s=.2*(1-Math.pow(s,5));for(var f=0;12>f;f+=3)c[o+f]=d,c[o+f+1]=s,c[o+f+2]=0}n.addAttribute("normal",new THREE.BufferAttribute(c,3));for(var o,f,g=new Uint16Array(6*r),d=0;r>d;d++)o=2*d*3,f=4*d,g[o]=f+0,g[o+1]=f+1,g[o+2]=f+2,g[o+3]=f+0,g[o+4]=f+2,g[o+5]=f+3;return n.setIndex(new THREE.BufferAttribute(g,1)),n.addGroup({start:0,count:6*r}),new THREE.Mesh(n,t)},app.CreateFontMesh=function(a,p,e,t,i){for(var r,n,o=app.fontTable,l=a.length,d=new THREE.BufferGeometry,u=p*(i?.666666:.5),c=0,s=0,f=0,g=new Float32Array(12*l),h=0;l>h;h++)n=a.charAt(h),c=128*o[n][4]/12,s=128*o[n][5]/12,r=4*h*3,g[r]=0+f,g[r+1]=-u*s,g[r+2]=0,g[r+3]=p*c+f,g[r+4]=-u*s,g[r+5]=0,g[r+6]=p*c+f,g[r+7]=u*s,g[r+8]=0,g[r+9]=0+f,g[r+10]=u*s,g[r+11]=0,f+=c*(p-.5);if(!t){f*=.5;for(var r,h=0;l>h;h++)r=4*h*3,g[r]-=f,g[r+3]-=f,g[r+6]-=f,g[r+9]-=f}d.addAttribute("position",new THREE.BufferAttribute(g,3));var m;m=new Float32Array(8*l);for(var r,n,h=0;l>h;h++)n=a.charAt(h),r=4*h*2,m[r]=o[n][0],m[r+1]=o[n][1],m[r+2]=o[n][0]+o[n][2],m[r+3]=o[n][1],m[r+4]=o[n][0]+o[n][2],m[r+5]=o[n][1]+o[n][3],m[r+6]=o[n][0],m[r+7]=o[n][1]+o[n][3];d.addAttribute("uv",new THREE.BufferAttribute(m,2));for(var r,v,T=new Uint16Array(6*l),h=0;l>h;h++)r=2*h*3,v=4*h,T[r]=v+0,T[r+1]=v+1,T[r+2]=v+2,T[r+3]=v+0,T[r+4]=v+2,T[r+5]=v+3;return d.setIndex(new THREE.BufferAttribute(T,1)),d.addGroup({start:0,count:6*l}),new THREE.Mesh(d,e)},app.CreateNumberMesh=function(a,p,e,t){for(var i,r,n=app.numberTable,o=a+parseInt((a-1)/3),l=0,d=new Array,u=new THREE.BufferGeometry,c=.5*p,s=0,f=0,g=0,h=!1,m=new Float32Array(12*o),v=0,T=-1;o>v;v++)(o-1-v)%4==3?(r=n[","],h=!0):(r=n[0],T++,h=!1),s=128*r[4]/12,f=128*r[5]/12,i=4*v*3,m[i]=0+l,m[i+1]=-c*f,m[i+2]=0,m[i+3]=p*s+l,m[i+4]=-c*f,m[i+5]=0,m[i+6]=p*s+l,m[i+7]=c*f,m[i+8]=0,m[i+9]=0+l,m[i+10]=c*f,m[i+11]=0,h||(g=a-T,d[g]||(d[g]=l)),l+=s*(p-.5);if(!t)for(var i,E=.5*l,v=0;o>v;v++)i=4*v*3,m[i]-=E,m[i+3]-=E,m[i+6]-=E,m[i+9]-=E;u.addAttribute("position",new THREE.BufferAttribute(m,3));var S;S=new Float32Array(8*o);for(var i,r,v=0;o>v;v++)r=n[(o-1-v)%4==3?",":"0"],i=4*v*2,S[i]=r[0],S[i+1]=r[1],S[i+2]=r[0]+r[2],S[i+3]=r[1],S[i+4]=r[0]+r[2],S[i+5]=r[1]+r[3],S[i+6]=r[0],S[i+7]=r[1]+r[3];u.addAttribute("uv",new THREE.BufferAttribute(S,2));var b;b=new Float32Array(12*o);for(var i,y,w,v=0;o>v;v++){i=4*v*3,(o-1-v)%4!=3?(y=Math.pow(10,--a),w=1):w=0;for(var T=0;12>T;T+=3)b[i+T]=y,b[i+T+1]=w,b[i+T+2]=0}u.addAttribute("normal",new THREE.BufferAttribute(b,3));for(var i,T,x=new Uint16Array(6*o),v=0;o>v;v++)i=2*v*3,T=4*v,x[i]=T+0,x[i+1]=T+1,x[i+2]=T+2,x[i+3]=T+0,x[i+4]=T+2,x[i+5]=T+3;return u.setIndex(new THREE.BufferAttribute(x,1)),u.addGroup({start:0,count:6*o}),[new THREE.Mesh(u,e),d]},app.GetNumberOffset=function(a,p,e){if(e){if(10>a)return-p[1];if(100>a)return-p[2];if(1e3>a)return-p[3];if(1e4>a)return-p[4];if(1e5>a)return-p[5];if(1e6>a)return-p[6];if(1e7>a)return-p[7];if(1e8>a)return-p[8];if(1e9>a)return-p[9]}else{if(10>a)return.5*-p[1];if(100>a)return.5*-p[2];if(1e3>a)return.5*-p[3];if(1e4>a)return.5*-p[4];if(1e5>a)return.5*-p[5];if(1e6>a)return.5*-p[6];if(1e7>a)return.5*-p[7];if(1e8>a)return.5*-p[8];if(1e9>a)return.5*-p[9]}return 0},app.GetNumberOffsetLeft=function(a,p,e){return 10>a?-e[1]:100>a?-e[2]:1e3>a?-e[3]:1e4>a?-e[4]:0},app.CreateBlurFontMesh=function(a,p,e,t,i){t||(t=1);for(var r,n,o,l=i?app.numberTable:app.fontTable,d=a.length,u=new THREE.BufferGeometry,c=.5*p,s=12*d,f=new Float32Array(s*t),g=0;t>g;g++){r=0,n=0,o=0;for(var h,m,v=0;d>v;v++)m=a.charAt(v),r=128*l[m][4]/12,n=128*l[m][5]/12,h=g*s+4*v*3,f[h]=0+o,f[h+1]=-c*n,f[h+2]=0,f[h+3]=p*r+o,f[h+4]=-c*n,f[h+5]=0,f[h+6]=p*r+o,f[h+7]=c*n,f[h+8]=0,f[h+9]=0+o,f[h+10]=c*n,f[h+11]=0,o+=r*(p-.5)}o*=.5;for(var g=0;t>g;g++)for(var h,v=0;d>v;v++)h=g*s+4*v*3,f[h]-=o,f[h+3]-=o,f[h+6]-=o,f[h+9]-=o;u.addAttribute("position",new THREE.BufferAttribute(f,3)),s=8*d;for(var T=new Float32Array(s*t),g=0;t>g;g++)for(var h,m,v=0;d>v;v++)m=a.charAt(v),h=g*s+4*v*2,T[h]=l[m][0],T[h+1]=l[m][1],T[h+2]=l[m][0]+l[m][2],T[h+3]=l[m][1],T[h+4]=l[m][0]+l[m][2],T[h+5]=l[m][1]+l[m][3],T[h+6]=l[m][0],T[h+7]=l[m][1]+l[m][3];u.addAttribute("uv",new THREE.BufferAttribute(T,2)),s=12*d;for(var E=new Float32Array(s*t),g=0;t>g;g++)for(var h,S,v=0;d>v;v++){h=g*s+4*v*3,S=.05;for(var b=0;12>b;b+=3)E[h+b]=g,E[h+b+1]=S,E[h+b+2]=0}u.addAttribute("normal",new THREE.BufferAttribute(E,3)),s=6*d;for(var y=new Uint16Array(s*t),g=0;t>g;g++)for(var h,b,v=0;d>v;v++)h=g*s+2*v*3,b=4*(g*d+v),y[h]=b+0,y[h+1]=b+1,y[h+2]=b+2,y[h+3]=b+0,y[h+4]=b+2,y[h+5]=b+3;return u.setIndex(new THREE.BufferAttribute(y,1)),u.addGroup({start:0,count:6*d*t}),new THREE.Mesh(u,e)},app.GyroCallback=function(a){var p=new THREE.Quaternion,e=app.deviceOrientation.getScreenAdjustedQuaternion();if(p.x=e.x,p.y=e.y,p.z=e.z,p.w=e.w,app.gyroInverseOrigin=p.clone().inverse(),app.gyroOrigin){p.multiply(app.gyroOrigin);var t=new THREE.Vector3(0,0,75).applyQuaternion(p),i=new THREE.Vector3(0,75,0).applyQuaternion(p);Math.abs(t.x)<Math.abs(i.x)&&(t.x=-i.x),app.cameraParallax[2]=-t.x,app.cameraParallax[3]=-t.y,app.gyroDistance=Math.abs(t.x)+Math.abs(t.y)}else app.gyroDistanceAvg<10?app.gyroDistanceAvg+=10/6:app.gyroOrigin=app.gyroInverseOrigin},app.DotFilter=function(a,p){app.tgtDotScale=a?0:1,p&&(app.dotScale=app.tgtDotScale,app.UpdateDotFilter())},app.UpdateDotFilter=function(){if(app.offline){var a=app.dotScale*(app.height-21)+21;app.frontMat.uniforms.round.value=app.backMat.uniforms.round.value=Math.max(0,app.height/a*.5),app.frontMat.uniforms.scale.value.x=a*app.width/app.height,app.backMat.uniforms.scale.value.x=a*app.holoWidth/app.height,app.frontMat.uniforms.scale.value.y=app.backMat.uniforms.scale.value.y=a}else{var a=app.dotScale*(app.width-21)+21;app.frontMat.uniforms.round.value=app.backMat.uniforms.round.value=Math.max(0,app.width/a*.5),app.frontMat.uniforms.scale.value.x=app.backMat.uniforms.scale.value.x=a,app.frontMat.uniforms.scale.value.y=app.backMat.uniforms.scale.value.y=a*app.height/app.width}},app.Update=function(){var a=+new Date/1e3;if(app.realDeltaTime=Math.min(1/24,a-app.realTime),app.realTime=a,app.pause>1&&app.realTime-app.pause>=.5&&(app.pause=0),app.gameInputFunction&&app.touchTime>0){var p=app.realTime-app.touchTime;p>=.2&&(app.touchFlag=!0,app.gameInputFunction(app.touchX))}app.offline&&(app.debug&&app.IsKeyTrigger(57)&&(app.debugShow=0==app.debugShow,app.debugEle&&(app.debugEle.style.display=app.debugShow?"block":"none")),app.IsKeyTrigger(56)&&app.Reset(),app.IsKeyTrigger(87)&&app.ChangeHolograph(0,1,0,0),app.IsKeyTrigger(83)&&app.ChangeHolograph(0,-1,0,0),app.IsKeyTrigger(65)&&app.ChangeHolograph(-1,0,0,0),app.IsKeyTrigger(68)&&app.ChangeHolograph(1,0,0,0),app.IsKeyTrigger(81)&&app.ChangeHolograph(0,0,-1,0),app.IsKeyTrigger(69)&&app.ChangeHolograph(0,0,1,0),app.IsKeyTrigger(70)&&app.ChangeHolograph(0,0,0,1),app.IsKeyTrigger(49)&&app.ChangePaddle(5),app.IsKeyTrigger(50)&&app.ChangePaddle(-5),app.IsKeyTrigger(54)&&app.ToggleSound()),0==app.pause?(app.deltaTime=app.realDeltaTime,app.time+=app.deltaTime,app.updating||(app.updating=!0,app.gameUpdateFunction&&app.gameUpdateFunction(),app.dotScale!=app.tgtDotScale&&(app.dotScale+=3*(app.tgtDotScale-app.dotScale)*app.deltaTime,app.UpdateDotFilter()),app.fade[0]!=app.fade[1]&&(app.fade[0]<app.fade[1]?app.fade[0]=Math.min(app.fade[0]+2*app.deltaTime,app.fade[1]):app.fade[0]>app.fade[1]&&(app.fade[0]=Math.max(app.fade[0]-.5*app.deltaTime,app.fade[1])),app.frontMat.uniforms.alpha.value=app.backMat.uniforms.alpha.value=app.fade[0]),app.offline||(app.soundIconMat.uniforms.alpha.value=Math.max(0,app.soundIconMat.uniforms.alpha.value-.5*app.deltaTime)),app.updating=!1)):app.deltaTime=0,app.drawing||(app.drawing=!0,app.gameDrawFunction&&app.gameDrawFunction(),app.Rendering(),app.fpsCount++,app.drawing=!1),requestAnimationFrame(app.Update),app.debugShow&&null!=app.fpsEle&&a-app.fpsTime>=1&&(app.fpsEle.innerHTML=(app.stats?"<br /><br /><br />":"")+app.fpsCount+"fps",app.fpsTime=a,app.fpsCount=0),app.stats&&app.stats.update()},app.ResetGyro=function(){app.deviceOrientation&&(app.deviceOrientation.stop(),app.gyroOrigin=void 0,app.gyroDistanceAvg=0,app.deviceOrientation.start()),app.cameraParallax=[0,0,0,0]},app.Rendering=function(){app.deviceOrientation&&(void 0!=app.gyroOrigin&&(app.gyroInverseOrigin&&(app.gyroOrigin.slerp(app.gyroInverseOrigin,Math.min(1,15*app.realDeltaTime)),app.gyroDistanceAvg+=3*(app.gyroDistance-app.gyroDistanceAvg)*app.realDeltaTime),0==app.pause&&app.gyroDistanceAvg<.666&&app.ResetGyro()),app.cameraParallax[0]+=15*(app.cameraParallax[2]-app.cameraParallax[0])*app.realDeltaTime,app.cameraParallax[1]+=15*(app.cameraParallax[3]-app.cameraParallax[1])*app.realDeltaTime,app.frontCamera.position.set(app.cameraParallax[0],app.cameraParallax[1],app.cameraDepth)),app.offline&&(app.cameraParallax[0]+=6*(app.cameraParallax[2]-app.cameraParallax[0])*app.realDeltaTime,app.cameraParallax[1]+=6*(app.cameraParallax[3]-app.cameraParallax[1])*app.realDeltaTime,app.frontCamera.position.set(app.cameraParallax[0],app.cameraParallax[1],app.cameraDepth),app.renderer.clearTarget(app.offRenderTarget,!0,!0,!1),app.renderer.render(app.offScene,app.frontCamera,app.offRenderTarget)),app.renderer.clearTarget(app.backRenderTarget,!0,!0,!1),app.renderer.render(app.backScene,app.frontCamera,app.backRenderTarget),app.offline&&app.renderer.clearTarget(app.backRenderTarget,!1,!0,!1),app.renderer.clearTarget(app.frontRenderTarget,!0,!0,!1),app.renderer.render(app.frontScene,app.frontCamera,app.frontRenderTarget),app.renderer.clearTarget(app.frontRenderTarget,!1,!0,!1),app.uiFix&&app.frontCamera.position.set(0,0,app.cameraDepth),app.renderer.render(app.uiScene,app.frontCamera,app.frontRenderTarget),app.offline&&app.renderer.render(app.uiBackScene,app.frontCamera,app.backRenderTarget),app.renderer.render(app.scene,app.camera)},app.IsKeyTrigger=function(a){var p=!1;return app.keyTrigger&&app.keyTrigger[a]&&(p=!0,app.keyTrigger[a]=0),p},app.ChangeHolograph=function(a,p,e,t){app.SetHolograph(app.holoPosX+a,app.holoPosY+p,app.holoScale+e,(app.holoFlip+t)%4)},app.SetHolograph=function(a,p,e,t){if(app.offline){app.holoPosX=a,app.holoPosY=p,app.holoScale=e,app.holoFlip=t,e=.01*(100+app.holoScale);var i=app.width/app.dispWidth*.5;app.backScreen.scale.set(e*i,e,1),app.backScreen.position.set(app.dispWidth*i*.5+app.holoPosX,app.holoPosY,-2),app.backScreen.rotation.set(1&app.holoFlip?Math.PI:0,2&app.holoFlip?Math.PI:0,0),app.resizeFunction&&app.resizeFunction(e,app.holoPosX/app.width,app.holoPosY/app.height,app.holoFlip),Cookies.set("app.holoPosX",app.holoPosX,{expires:365}),Cookies.set("app.holoPosY",app.holoPosY,{expires:365}),Cookies.set("app.holoScale",app.holoScale,{expires:365}),Cookies.set("app.holoFlip",app.holoFlip,{expires:365}),null!=app.holographEle&&(app.holographEle.innerHTML="holo scale: "+(100+app.holoScale)+"%<br />holo offset: "+app.holoPosX+", "+app.holoPosY+"<br />holo flip: "+app.holoFlip+"<br />")}},app.Reset=function(){app.offline&&(app.SetHolograph(config.holoOffsetX||0,config.holoOffsetY||0,config.holoScale-100||0,config.holoFlip||0),app.SetPaddle(10*(100-config.paddleSpeed)||50))},app.OnMouseMove=function(a){return void 0==app.mouseX?app.mouseX=a.clientX:a.clientX<app.mouseX-app.paddleSpeed?app.mouseX=a.clientX+app.paddleSpeed:a.clientX>app.mouseX+app.paddleSpeed&&(app.mouseX=a.clientX-app.paddleSpeed),app.mouseX<app.paddleSpeed?app.mouseX=app.paddleSpeed:app.mouseX>app.canvas.clientWidth-app.paddleSpeed&&(app.mouseX=app.canvas.clientWidth-app.paddleSpeed),app.paddleX=Math.max(-1,Math.min(1,(a.clientX-app.mouseX)/app.paddleSpeed)),!1},app.TouchReset=function(){app.touchX=.5*app.canvas.clientWidth,app.touchY=.5*app.canvas.clientHeight,app.paddleX=0,app.mouseX=void 0},app.ChangePaddle=function(a){a=app.paddleSpeed+a,app.SetPaddle(a)},app.SetPaddle=function(a){app.offline&&(10>a?a=10:a>990&&(a=990),app.paddleSpeed=a,app.TouchReset(),Cookies.set("app.paddleSpeed",app.paddleSpeed,{expires:365}),null!=app.controleEle&&(app.controleEle.innerHTML="paddle speed: "+(1e3-app.paddleSpeed)/10))},app.touchStartX=0,app.touchTime=0,app.touchFlag=!1,app.OnTouch=function(a,p){var e=a.changedTouches[0];return app.touchX=e.pageX,app.touchY=e.pageY,p?(app.touchTime=app.realTime,app.touchStartX=e.pageX):app.touchFlag&&app.gameInputFunction&&app.gameInputFunction(app.touchX),!1},app.OnTouchEnd=function(a){var p=a.changedTouches[0];if(app.touchX=p.pageX,app.touchY=p.pageY,!app.touchFlag){var e=p.pageX-app.touchStartX;Math.abs(e)>=32?app.gameInputFunction&&(0>e?app.gameInputFunction(app.touchX,-1):app.gameInputFunction(app.touchX,1)):app.gameInputFunction&&app.gameInputFunction(app.touchX)}return app.touchTime=0,app.touchFlag=!1,!1},app.TouchX=function(a){return(app.offline?app.paddleX:2*app.touchX/app.canvas.clientWidth-1)*(a?1:.5*app.width)},app.ToggleSound=function(a){var p=ap.IsOn();a||(p=0==p,ap.Toggle(p)),app.offline||(app.soundIcon[p?0:1].visible=!0,app.soundIcon[p?1:0].visible=!1,app.soundIconMat.uniforms.alpha.value=a?0:1.125)},app.Fade=function(a,p){app.fade[1]=a,p&&(app.fade[0]=a,app.frontMat.uniforms.alpha.value=app.backMat.uniforms.alpha.value=a)},app.GetUrlVars=function(){for(var a={},p=location.search.substring(1).split("&"),e=0;e<p.length;e++){var t=p[e].search(/=/),i="";-1!=t&&(i=p[e].slice(0,t));var r=p[e].slice(p[e].indexOf("=",0)+1);""!=i&&(a[i]=decodeURI(r))}return a},app.EaseIn=function(a,p,e){return e=Math.min(1,e),p-=a,p*e*e+a},app.EaseOut=function(a,p,e){return e=Math.min(1,e),p-=a,-p*e*(e-2)+a},app.EaseInOut=function(a,p,e){return e=Math.min(1,e),p-=a,e/=.5,1>e?.5*p*e*e+a:(e-=1,.5*-p*(e*(e-2)-1)+a)},app.CircularEaseInOut=function(a,p,e){return p-=a,e/=.5,1>e?-p/2*(Math.sqrt(1-e*e)-1)+a:(e-=2,p/2*(Math.sqrt(1-e*e)+1)+a)},app.QuarticEaseIn=function(a,p,e){return p-=a,p*e*e*e*e+a},app.QuarticEaseOut=function(a,p,e){return p-=a,e-=1,-p*(e*e*e*e-1)+a},app.Shuffle=function(a){for(var p,e,t=a.length;t;)e=Math.floor(Math.random()*t--),p=a[t],a[t]=a[e],a[e]=p;return a},app.Initialize=function(a,p,e,t,i,r,n,o){app.debugEle=document.getElementById("debug"),app.fpsEle=document.getElementById("debugFps"),app.holographEle=document.getElementById("debugHolograph"),app.controleEle=document.getElementById("debugControl"),app.tempEle=document.getElementById("debugTemp"),app.offline="offline"==a,app.debug=void 0!=p&&app.debugEle,app.offline||(app.debugShow=app.debug),app.debugEle&&(app.debugEle.style.display=app.debugShow?"block":"none"),void 0!=t&&(app.initializedFunction=t),void 0!=i&&(app.landscapeFunction=i),void 0!=r&&(app.unsupportedFunction=r),void 0!=n&&(app.resizeFunction=n),void 0!=o&&(app.disableGyro=o?!0:!1),app.offline?app.InitializeSub():app.WaitPortrait()},app.WaitPortrait=function(){$(window).width()>$(window).height()?(app.landscapeFunction&&app.landscapeFunction(!0),setTimeout(function(){app.WaitPortrait()},100)):(app.landscapeFunction&&app.landscapeFunction(!1),app.InitializeSub())},app.Unsupported=function(){app.unsupportedFunction&&app.unsupportedFunction(!1)},app.InitializeSub=function(){if(app.debugShow&&(app.tempEle.innerHTML="app.init "+ ++app.initCode+":"+app.initialized),app.clientWidth=$(window).width(),app.clientHeight=$(window).height(),app.offline?(app.height=288,app.width=16*app.height/9,app.holoWidth=16*app.height/9,app.dispWidth=16*app.height/9,app.dispHeight=app.height):(app.width=Math.floor(.5*app.clientWidth),app.height=Math.floor(571*app.width/375),app.holoWidth=app.width,app.dispWidth=app.width,app.dispHeight=app.height),app.InitThree(),app.InitCamera(),app.InitOffscreen(),app.textureLoader=new THREE.TextureLoader,app.debugShow&&(app.tempEle.innerHTML="app.init "+ ++app.initCode+":"+app.initialized),app.frontMat=new THREE.ShaderMaterial({uniforms:{tDiffuse:{value:app.frontRenderTarget.texture},scale:{value:new THREE.Vector2(app.width,app.height)},round:{value:0},alpha:{value:0}},side:THREE.DoubleSide,vertexShader:app.DotShader.vertexShader,fragmentShader:app.DotShader.fragmentShader}),app.offline||(app.frontMat.blending=THREE.NormalBlending,app.frontMat.blendEquation=THREE.AddEquation,app.frontMat.premultipliedAlpha=!0,app.frontMat.transparent=!0),app.frontScreen=app.CreateMesh(app.width,app.height,0,app.frontMat),app.frontScreen.scale.set(1,1,1),app.frontScreen.position.set(0,0,0),app.frontScreen.rotation.set(0,0,0),app.backMat=new THREE.ShaderMaterial({uniforms:{tDiffuse:{value:app.backRenderTarget.texture},scale:{value:new THREE.Vector2(app.holoWidth,app.height)},round:{value:0},alpha:{value:0}},side:THREE.DoubleSide,vertexShader:app.DotShader.vertexShader,fragmentShader:app.DotShader.fragmentShader}),app.backScreen=app.CreateMesh(app.holoWidth,app.height,0,app.backMat),app.backScreen.scale.set(1,1,1),app.backScreen.position.set(0,0,-2),app.backScreen.rotation.set(0,0,0),app.scene.add(app.backScreen),app.scene.add(app.frontScreen),app.offline){var a=app.width/app.dispWidth*.5;app.frontScreen.scale.set(a,1,1),app.frontScreen.position.set(-app.dispWidth*a*.5,0,0),app.backScreen.scale.set(app.width/app.dispWidth*.5,1,1),app.backScreen.position.set(app.dispWidth*a*.5,0,-2)}app.debugShow&&(app.tempEle.innerHTML="app.init "+ ++app.initCode+":"+app.initialized),app.textureLoader.load(app.offline?"./img/textureOffline.png":"./img/texture.png",function(a){
if(a.format=THREE.RGBAFormat,a.generateMipmaps=!1,a.minFilter=THREE.NearestFilter,a.magFilter=THREE.NearestFilter,app.texture=a,app.offline){app.mask=new Array,app.maskMat=new Array;for(var p=0;2>p;p++)app.maskMat[p]=new THREE.ShaderMaterial({uniforms:{texture:{value:app.texture},alpha:{value:1}},blending:THREE.NormalBlending,transparent:!0,depthWrite:!1,vertexShader:app.PlaneShader.vertexShader,fragmentShader:app.PlaneShader.fragmentShader}),app.mask[p]=app.CreateMesh(4e3,4e3,0,app.maskMat[p],app.table.Mask),app.mask[p].position.set(0,0,-1e3),0==p?(app.uiScene.add(app.mask[p]),app.mask[p].visible=!1):app.uiBackScene.add(app.mask[p])}app.initialized++,app.debugShow&&(app.tempEle.innerHTML="app.init "+ ++app.initCode+":"+app.initialized)}),app.textureLoader.load("./img/font.png",function(a){a.format=THREE.RGBAFormat,a.generateMipmaps=!1,a.minFilter=THREE.LinearFilter,a.magFilter=THREE.NearestFilter,app.fontTexture=a,app.initialized++,app.debugShow&&(app.tempEle.innerHTML="app.init "+ ++app.initCode+":"+app.initialized)}),app.textureLoader.load("./img/number.png",function(a){a.format=THREE.RGBAFormat,a.generateMipmaps=!1,a.minFilter=THREE.LinearFilter,a.magFilter=THREE.NearestFilter,app.numberTexture=a,app.initialized++,app.debugShow&&(app.tempEle.innerHTML="app.init "+ ++app.initCode+":"+app.initialized)}),app.textureLoader.load("./img/symbols.png",function(a){a.format=THREE.RGBAFormat,a.generateMipmaps=!0,a.minFilter=THREE.LinearFilter,a.magFilter=THREE.LinearFilter,app.symbolTexture=a,app.initialized++,app.debugShow&&(app.tempEle.innerHTML="app.init "+ ++app.initCode+":"+app.initialized)}),app.textureLoader.load("./img/volume.png",function(a){a.format=THREE.RGBAFormat,a.generateMipmaps=!0,a.minFilter=THREE.LinearFilter,a.magFilter=THREE.LinearFilter,app.offline||(app.soundIcon=new Array,app.soundIconMat=new THREE.ShaderMaterial({uniforms:{texture:{value:a},alpha:{value:0}},blending:THREE.AdditiveBlending,transparent:!0,depthWrite:!1,vertexShader:app.PlaneShader.vertexShader,fragmentShader:app.PlaneShader.fragmentShader}),app.soundIcon[0]=app.CreateMesh(26,26,0,app.soundIconMat,[0,0,.5,1,1,1]),app.soundIcon[0].position.set(-72,112.25,.1),app.soundIcon[0].visible=!1,app.uiScene.add(app.soundIcon[0]),app.soundIcon[1]=app.CreateMesh(26,26,0,app.soundIconMat,[.5,0,.5,1,1,1]),app.soundIcon[1].position.set(-72,112.25,.1),app.soundIcon[1].visible=!1,app.uiScene.add(app.soundIcon[1])),app.initialized++,app.debugShow&&(app.tempEle.innerHTML="app.init "+ ++app.initCode+":"+app.initialized)}),window.onresize=app.OnWindowResizeThree,app.offline&&app.OnWindowResizeThree(),setTimeout(function(){if(app.offline)$("html").on("mousemove",function(a){app.OnMouseMove(a)}),app.keyDown=new Array,app.keyTrigger=new Array,$(window).keydown(function(a){void 0==app.keyDown[a.keyCode]&&(app.keyDown[a.keyCode]=app.realTime,app.keyTrigger[a.keyCode]=!0)}),$(window).keyup(function(a){app.keyDown[a.keyCode]=void 0});else{var a=$("canvas");("ontouchstart"in window||navigator.msPointerEnabled)&&(a.on("touchstart",function(a){return app.OnTouch(a,!0)}),a.on("touchmove",function(a){return app.OnTouch(a,!1)}),a.on("touchend touchleave touchcancel",function(a){return app.OnTouchEnd(a)}))}app.TouchReset(),app.initialized++,app.debugShow&&(app.tempEle.innerHTML="app.init "+ ++app.initCode+":"+app.initialized)},125),app.TouchReset(),app.offline||app.disableGyro||setTimeout(function(){var a=new FULLTILT.getDeviceOrientation({type:"game"});a.then(function(a){app.deviceOrientation=a,app.deviceOrientation.stop(),app.deviceOrientation.start(app.GyroCallback)})["catch"](function(a){console.error(a),app.debugShow&&(app.initCode+=500,app.tempEle.innerHTML="app.init "+app.initCode+":"+app.initialized)}),app.debugShow&&(app.tempEle.innerHTML="app.init "+ ++app.initCode+":"+app.initialized)},250),app.debug&&app.offline&&(app.stats=new Stats,app.debugEle.insertBefore(app.stats.dom,app.debugEle.firstChild)),app.Fade(0,!0),app.Rendering(),setTimeout(function(){app.WaitInitialized()},50),app.debugShow&&(app.tempEle.innerHTML="app.init "+ ++app.initCode+":"+app.initialized)},app.IsInitialized=function(){return app.initialized>=6},app.WaitInitialized=function(){if(app.IsInitialized()){if(app.offline){var a=parseInt(Cookies.get("app.holoPosX"));isNaN(a)&&(a=config.holoOffsetX||0);var p=parseInt(Cookies.get("app.holoPosY"));isNaN(p)&&(p=config.holoOffsetY||0);var e=parseInt(Cookies.get("app.holoScale"));isNaN(e)&&(e=config.holoScale-100||0);var t=parseInt(Cookies.get("app.holoFlip"));isNaN(t)&&(t=config.holoFlip||0),app.SetHolograph(a,p,e,t);var i=parseInt(Cookies.get("app.paddleSpeed"));isNaN(i)&&(i=void 0!==config.paddleSpeed?10*(100-config.paddleSpeed):50),app.SetPaddle(i)}void 0!=app.initializedFunction&&app.initializedFunction()}else app.debugShow&&(app.tempEle.innerHTML="app.initWait "+app.initCode+":"+app.initialized),setTimeout(function(){app.WaitInitialized()},100)},app.Start=function(){setTimeout(function(){app.realTime=+new Date/1e3,app.fpsTime=app.realTime-1,app.fpsCount=0,app.time=0,requestAnimationFrame(app.Update)},50)};var ap=ap||{};ap.audio=document.getElementById("Audio"),ap.canPlay=!1,ap.fadeout=!1,ap.masterVolume=1,ap.volume=1,ap.playing=!0,ap.prePlaying=!1,ap.time=0,ap.startTime=0,ap.InitAudio=function(){ap.audio.load(),ap.audio.volume=ap.volume=0,ap.audio.muted=!0;var a=parseInt(Cookies.get("ap.masterVolume"));ap.masterVolume=isNaN(a)?1:a,4===ap.audio.readyState?ap.canPlay=!0:ap.audio.addEventListener("canplay",function(){ap.canPlay=!0},!1)},ap.PrePlay=function(){ap.audio.volume=ap.volume=0,ap.audio.muted=!0,ap.playing=!0,ap.prePlaying=!0,ap.startTime=0,ap.audio.loop=!0,ap.audio.currentTime=ap.audio.duration-.1,ap.Toggle(ap.masterVolume>0,!0)},ap.Play=function(a){ap.canPlay&&(ap.fadeout=!1,ap.volume=1,ap.playing=!0,ap.prePlaying=!1,ap.startTime=ap.time,ap.audio.currentTime=0,ap.audio.volume=0,ap.audio.loop=a,ap.Toggle(ap.masterVolume>0,!0))},ap.Stop=function(a){a?(ap.audio.pause(),ap.audio.currentTime=ap.audio.duration,ap.playing=!1,ap.fadeout=!1,ap.startTime=0):(ap.playing=!1,ap.fadeout=!0)},ap.Update=function(a,p,e){ap.time=a,ap.prePlaying&&(ap.audio.currentTime=ap.audio.duration-.1),ap.fadeout&&(ap.volume-=p,ap.volume<=0&&(ap.volume=0,ap.fadeout=!1,ap.playing=!1,ap.startTime=0,ap.audio.pause(),ap.audio.currentTime=ap.audio.duration)),ap.audio.volume=ap.masterVolume*ap.volume,ap.audio.muted=ap.masterVolume*ap.volume<=0},ap.Mute=function(a){a?ap.audio.pause():ap.Toggle(ap.masterVolume>0,!0)},ap.Toggle=function(a,p){ap.masterVolume=a?1:0,a?ap.playing&&!ap.fadeout&&ap.canPlay&&(ap.startTime>0?(ap.audio.currentTime=ap.time-ap.startTime,ap.audio.loop&&(ap.audio.currentTime%=ap.audio.duration)):ap.audio.currentTime=ap.audio.duration-.1,ap.audio.currentTime<ap.audio.duration&&ap.audio.play()):ap.audio.pause(),p||Cookies.set("ap.masterVolume",ap.masterVolume,{expires:365})},ap.IsOn=function(){return ap.masterVolume>0};